# Getting started developing on top of our kernel agent

> [!NOTE]  
> Scripts referred throughout this guide are available at https://github.com/danielhua23/ai_sprint_shanghai/blob/main/scripts.

First, clone the repo

```sh
git clone https://github.com/danielhua23/ai_sprint_shanghai
cd ai_sprint_shanghai/scripts/track2-agent
```

## Clone kernel agent for local development in the devcloud VM

```bash
git clone https://github.com/danielhua23/hackathon-agent 
```

## Start the kernel agent development and evaluation docker container

This script will [start a docker container](https://github.com/danielhua23/ai_sprint_shanghai/blob/main/scripts/track2-agent/0_container.sh) with pytorch pre-installed. The container runs the image `rocm/pytorch:latest`.

```sh
chmod +x 0_container.sh
chmod +x 1_bench.sh
./0_container.sh
```

Once the docker container is started, you should should see the scripts from https://github.com/danielhua23/ai_sprint_shanghai/blob/main/scripts/track2-agent mounted into the container at `/workspace`.
## Run your kernel agent

the docker container launch script provided at https://github.com/danielhua23/ai_sprint_shanghai/blob/main/scripts/0_container.sh mounts a local `${PWD}/hackathon-agent` into `/hackathon-agent` in the container. This is to ease development e.g. through remote VS Code usage.

Once in the container, you can run the kernel agent by below steps

0. check in a new branch(important)
   ```
   cd /hackathon-agent
   git checkout -b your_branch_name
   ```

1. prepare the environment
   ```
   python3 -m pip install -r requirements.txt
   ```

2. go to the src/ folder
   ```
   cd src
   ```

3. edit config file. You need to give your API key from [1_get_apikey_from_wisemodel](https://github.com/danielhua23/ai_sprint_shanghai/tree/main/hackathon_guides/track2-agent/1_get_apikey_from_wisemodel) into your config file. <u>**‚ö†Important!!!: since the time that agent run 1 iteration is about 5-7 mins, so we constrained the max_iteration = 5 in the config for simplicity, you don't have to modify it**</u>
   ```
   vi configs/tritonbench_oneshot_config.yaml
   ```
   
4. kernel generation
   ```
   python main_reflexion_oneshot.py
   ```

while the kernel is generating, you will see the info like below picture

<img width="1140" height="761" alt="image" src="https://github.com/user-attachments/assets/eb1ca954-20ae-4497-8ec2-2f95c0891e4b" />

and when the program done, by default you will see the output files including generated kernels under `/workspace` like `reflexion_oneshot_tritonbench_0.json` where `0` represent the kernels generated in iteration 0

## VS Code usage

If you would like to use VS Code for remote development, refer to: https://code.visualstudio.com/docs/remote/ssh. You may need to install the [Remote - SSH](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh) extension, and attach VS Code to the VM with:

```
CTRL + ATL + P
> Remote-SSH: Connect to Host...
Add New SSH Host
ssh root@{your VM ip}
```

In case this does not work, you may need to specify your ssh key to use:

```
CTRL + ATL + P
> Remote-SSH: Connect to Host...
Configure SSH Hosts...
```

and add to the relevant SSH config file:

```
Host hackathon
  HostName your.node.ip.address
  User root
  IdentityFile ~/path/to/ssh_key
```

## Now navigate to the next section

Now you can check performance of kernel generated by agent and how to use HF leaderboard
üèÉ‚Äç‚û°Ô∏è [hackathon_start](https://github.com/danielhua23/ai_sprint_shanghai/tree/main/hackathon_guides/track2-agent/3_benchmark_generated_kernel)


